# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä—É–ø–ø –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –≤ Active Directory

–≠—Ç–æ—Ç PowerShell-—Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –≥—Ä—É–ø–ø Active Directory, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏ (–ø–æ —à–∞–±–ª–æ–Ω—É `printer*` –∏ `printerSPB*`), –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á—ë—Ç–∞ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∏–º–µ—é—â–∏—Ö –∫ –Ω–∏–º –¥–æ—Å—Ç—É–ø ‚Äî –≤–∫–ª—é—á–∞—è —Ç–µ—Ö, –∫—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —á–ª–µ–Ω—Å—Ç–≤–∞.

---

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–í –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º —á–∞—Å—Ç–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Active Directory. –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:

- –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –≥—Ä—É–ø–ø—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —à–∞–±–ª–æ–Ω–∞–º:
  - `printer123`
  - `printerSPB456`
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã.
- –°–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏–º–µ—é—â–∏—Ö –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º.
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–ª–∏ –∞—É–¥–∏—Ç–∞.

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Windows —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –º–æ–¥—É–ª–µ–º **Active Directory PowerShell (RSAT)**.
- –ü—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ Active Directory (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ–º–µ–Ω–∞ –∏–ª–∏ —á–ª–µ–Ω–∞ –≥—Ä—É–ø–ø—ã `Domain Admins`).
- PowerShell 5.1 –∏–ª–∏ –≤—ã—à–µ.

> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ RSAT (–Ω–∞ Windows 10/11/2016+):
> ```powershell
> Add-WindowsCapability -Name OpenSSH.Client~~~~0.0.1.0 -Online
> # –î–ª—è RSAT:
> Get-WindowsCapability -Name "Rsat.ActiveDirectory.DS-LDS.Tools*" -Online | Add-WindowsCapability -Online
> ```

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –°–æ—Ö—Ä–∞–Ω–∏ —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ `Get-PrinterAccessReport.ps1`.
2. –ó–∞–ø—É—Å—Ç–∏ PowerShell **–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**.
3. –í—ã–ø–æ–ª–Ω–∏:

```powershell
.\Get-PrinterAccessReport.ps1
